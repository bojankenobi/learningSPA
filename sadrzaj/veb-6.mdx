# 6. JS Modul 4: Validacija, Podaci i API

DobrodoÅ¡li u finalni modul veb razvoja! Do sada smo nauÄili kako da menjamo elemente na ekranu. MeÄ‘utim, prave aplikacije moraju da komuniciraju sa korisnikom (kroz forme), da Äuvaju podatke (da se ne bi obrisali kada osveÅ¾imo stranicu) i da povlaÄe informacije sa interneta (sa servera).

U ovom modulu spremamo vas za izradu zavrÅ¡nog, maturskog projekta!

---

## Nedelja 13: Validacija formi

Kada korisnik popunjava formu (npr. registracija), mi moramo da proverimo da li je uneo ispravne podatke *pre* nego Å¡to ih poÅ¡aljemo dalje. To se zove **validacija**.

KljuÄna stvar kod formi je spreÄavanje njenog podrazumevanog ponaÅ¡anja. Kada kliknete "Submit" u HTML formi, brauzer automatski osveÅ¾ava stranicu. Mi to ne Å¾elimo! Zato koristimo `e.preventDefault()`.

```html
<form id="moja-forma">
    <input type="text" id="ime" placeholder="Unesite ime">
    <button type="submit">PoÅ¡alji</button>
</form>
<p id="greska" style="color: red;"></p>
```

```javascript
let forma = document.getElementById("moja-forma");
let inputIme = document.getElementById("ime");
let poljeGreska = document.getElementById("greska");

// SluÅ¡amo dogaÄ‘aj "submit" na formi, a ne "click" na dugmetu!
forma.addEventListener("submit", function(e) {
    // 1. ZAUSTAVLJAMO OSVEÅ½AVANJE STRANICE
    e.preventDefault(); 

    // 2. ÄŒitamo Å¡ta je korisnik ukucao
    let unetoIme = inputIme.value;

    // 3. Validacija (Provera)
    if (unetoIme === "") {
        poljeGreska.textContent = "Ime ne sme biti prazno!";
    } else if (unetoIme.length < 3) {
        poljeGreska.textContent = "Ime mora imati bar 3 slova.";
    } else {
        poljeGreska.textContent = "";
        console.log(`UspeÅ¡no ste uneli ime: ${unetoIme}`);
    }
});
```

### VeÅ¾ba: Validacija forme uÅ¾ivo
PokuÅ¡aj da poÅ¡aljeÅ¡ prazno polje i prati poruku u konzoli ispod editora!

<CodePlayground 
  mode="console"
  defaultJs={`function proveriUnos(tekst) {
    if (tekst === "") {
        console.error("GREÅ KA: Polje ne sme biti prazno!");
    } else if (tekst.length < 5) {
        console.log("UPOZORENJE: Unos je prekratak.");
    } else {
        console.log("USPEH: Podaci spremni za slanje: " + tekst);
    }
}

// Simulacija unosa
proveriUnos("");
proveriUnos("Abc");
proveriUnos("Marko Markovic");`}
/>

---

## Nedelja 14: JSON i LocalStorage

Kada promenimo neÅ¡to na stranici preko JS-a, sve se resetuje Äim korisnik osveÅ¾i stranicu (F5). Da bismo trajno saÄuvali podatke *u brauzeru korisnika*, koristimo **LocalStorage**.

LocalStorage moÅ¾e da Äuva samo tekst (String). Zato koristimo **JSON** (JavaScript Object Notation) format da pretvorimo naÅ¡e nizove i objekte u obiÄan tekst kada ih Äuvamo, i obrnuto kada ih Äitamo.

```javascript
// 1. ÄŒUVANJE PODATAKA
let korisnik = { ime: "Petar", poeni: 150 };

// Pretvaramo objekat u JSON tekst: '{"ime":"Petar","poeni":150}'
let korisnikJSON = JSON.stringify(korisnik);

// ÄŒuvamo u LocalStorage pod kljuÄem "mojKorisnik"
localStorage.setItem("mojKorisnik", korisnikJSON);

// ----------------------------------------------------

// 2. ÄŒITANJE PODATAKA (Äak i nakon Å¡to se ugasi brauzer)
let sacuvaniPodaciTekst = localStorage.getItem("mojKorisnik");

if (sacuvaniPodaciTekst !== null) {
    // VraÄ‡amo JSON tekst nazad u pravi JavaScript objekat
    let sacuvaniKorisnik = JSON.parse(sacuvaniPodaciTekst);
    console.log(`DobrodoÅ¡ao nazad, ${sacuvaniKorisnik.ime}!`);
} else {
    console.log("Nema saÄuvanih podataka.");
}
```

<Quiz pitanje="Koja komanda se koristi za pretvaranje JavaScript objekta u JSON tekst?" opcije="JSON.parse()|JSON.stringify()|localStorage.setItem()|toString()" tacanOdgovorIndex="1" />

---

## Nedelja 15: Asinhroni JavaScript (Fetch API)

Ponekad naÅ¡ program mora da saÄeka neÅ¡to. Na primer, traÅ¾imo vremensku prognozu od servera, i to traje 2 sekunde. Ne smemo da "zamrznemo" ceo sajt dok Äekamo. Za to sluÅ¾i **Asinhroni JavaScript**.



Da bismo komunicirali sa spoljnim API-jima (serverima), koristimo ugraÄ‘enu metodu `fetch()`. Uz nju idu kljuÄne reÄi `async` i `await` koje kaÅ¾u kodu: *"Pokreni ovo, ali saÄekaj (await) da stignu podaci pre nego Å¡to nastaviÅ¡ na sledeÄ‡u liniju."*

```javascript
// Funkcija mora imati reÄ 'async' da bismo koristili 'await' unutra
async function preuzmiKorisnike() {
    try {
        console.log("Å aljem zahtev serveru...");

        // 'await' pauzira OVOJ funkciji izvrÅ¡avanje dok server ne odgovori
        let odgovor = await fetch("[https://jsonplaceholder.typicode.com/users](https://jsonplaceholder.typicode.com/users)");
        
        // Pretvaramo odgovor servera u JS niz/objekat
        let podaci = await odgovor.json(); 

        console.log("Podaci su stigli!");
        
        // Ispisujemo ime prvog korisnika sa servera
        console.log(`Prvi korisnik se zove: ${podaci[0].name}`);

    } catch (greska) {
        // Ako pukne internet ili server ne radi, hvatamo greÅ¡ku ovde
        console.log("DoÅ¡lo je do greÅ¡ke:", greska);
    }
}

// Pozivamo funkciju
preuzmiKorisnike();
console.log("Ova linija se ispisuje ODMAH, ne Äeka server!");
```

---

## Nedelja 16: ZavrÅ¡ni projekat

Stigli ste do kraja! Posedujete sve veÅ¡tine potrebne da izgradite modernu, interaktivnu veb aplikaciju. 

**Ideje za vaÅ¡ maturski/zavrÅ¡ni projekat:**
1. **To-Do Aplikacija sa LocalStorage:** Aplikacija gde korisnik moÅ¾e da doda zadatke, obriÅ¡e ih, precrta ih, i svi zadaci ostaju saÄuvani i nakon gaÅ¡enja brauzera.
2. **Vremenska prognoza:** Aplikacija koja traÅ¾i od korisnika da unese grad, a zatim preko `fetch` API-ja komunicira sa javnim meteo serverom i prikazuje temperaturu na ekranu.
3. **Interaktivni CV Generator:** Forma koju korisnik popunjava, a JS u realnom vremenu na desnoj strani ekrana generiÅ¡e lep HTML/CSS dokument za Å¡tampu.

---

# Zadaci za VeÅ¾bu (Modul 4)

Ovo su pravi, inÅ¾enjerski izazovi. Razmislite o logici pre nego Å¡to pogledate reÅ¡enje.

### Zadatak 1: Validacija lozinke
Imate input polje za lozinku i dugme. NapiÅ¡ite funkciju koja se okida na klik dugmeta, uzima vrednost iz polja, i proverava:
1. Da li je lozinka duÅ¾a od 8 karaktera?
2. Da li sadrÅ¾i reÄ "password" (ako sadrÅ¾i, odbiti je).

<ZadatakZaVezbu 
  naslov="ReÅ¡enje: Validacija lozinke"
  kod={`let inputLozinka = document.getElementById("lozinka-polje");
let dugme = document.getElementById("proveri-btn");

dugme.addEventListener("click", function() {
    let unetaLozinka = inputLozinka.value;

    // Proveravamo duÅ¾inu
    if (unetaLozinka.length < 8) {
        console.log("Lozinka mora imati barem 8 karaktera.");
    } 
    // Proveravamo da li sadrÅ¾i zabranjenu reÄ (koristimo metodu includes)
    else if (unetaLozinka.includes("password")) {
        console.log("Lozinka ne sme sadrÅ¾ati reÄ 'password'.");
    } 
    else {
        console.log("Lozinka je bezbedna!");
    }
});`}
  analiza="Metoda stringa .includes() je izuzetno korisna za ovakve provere. U realnom sistemu, dodali bismo i Regex da proverimo da li korisnik ima veliko slovo i broj."
/>

### Zadatak 2: ÄŒuvanje teme u LocalStorage
Napravite logiku koja na klik dugmeta menja temu sajta (dark/light), ali je usput Äuva u `localStorage` pod kljuÄem `odabranaTema`. 

<ZadatakZaVezbu 
  naslov="ReÅ¡enje: ÄŒuvanje u LocalStorage"
  kod={`let dugmeTema = document.getElementById("tema-dugme");

dugmeTema.addEventListener("click", function() {
    // 1. Menjamo klasu na body elementu
    document.body.classList.toggle("dark-mode");

    // 2. Proveravamo da li je klasa sada prisutna
    let daLiJeTamna = document.body.classList.contains("dark-mode");

    // 3. ÄŒuvamo taj podatak u LocalStorage (Äuvamo obiÄan tekst "da" ili "ne")
    if (daLiJeTamna) {
        localStorage.setItem("odabranaTema", "da");
    } else {
        localStorage.setItem("odabranaTema", "ne");
    }
});

// Prijateljski savet: Kada se sajt tek uÄitava, treba proÄitati 
// ovaj 'item' iz localStorage i dodati klasu ako piÅ¡e "da"!`}
  analiza="Ovo je Å¡kolski primer kako se prave profesionalni sajtovi. Nije dovoljno samo promeniti boju, sajt mora da 'zapamti' korisnikov izbor za sledeÄ‡i put kada poseti stranicu."
/>

### Zadatak 3: Preuzimanje jednog korisnika (Fetch API)
NapiÅ¡ite asinhronu funkciju koja koristi `fetch` da pogodi sledeÄ‡i URL: `https://jsonplaceholder.typicode.com/users/1`. (Ovo je javni test server). Kada stignu podaci o tom jednom korisniku, ispiÅ¡ite u konzolu njegov `email`.

<ZadatakZaVezbu 
  naslov="ReÅ¡enje: Fetch API"
  kod={`async function dobaviEmail() {
    try {
        let odgovor = await fetch("https://jsonplaceholder.typicode.com/users/1");
        
        // Pretvaramo odgovor u JS objekat
        let korisnik = await odgovor.json();
        
        // jsonplaceholder API vraÄ‡a objekat koji ima svojstvo 'email'
        console.log(\`Korisnikov email je: \${korisnik.email}\`);

    } catch (greska) {
        console.error("GreÅ¡ka pri komunikaciji sa serverom:", greska);
    }
}

dobaviEmail();`}
  analiza="Uvek koristite 'try/catch' blokove kada radite sa fetch komandom. Internet konekcija moÅ¾e da pukne svakog trenutka, a bez 'catch' bloka, vaÅ¡ ceo JavaScript program bi pao i zaustavio se."
/>

# PraktiÄni JS Projekti i Izazovi

U ovoj lekciji primeniÄ‡emo sve nauÄeno kroz tri kompletna mini-projekta. Svaki zadatak sadrÅ¾i detaljnu postavku, interaktivni editor za veÅ¾bu i **skriveno reÅ¡enje** koje moÅ¾ete otkljuÄati.

---

## Zadatak 1: Pametni Kalkulator BakÅ¡iÅ¡a ğŸ’°

**Postavka zadatka 1:**
Napravite aplikaciju koja na osnovu unetog iznosa raÄuna i odabranog procenta raÄuna bakÅ¡iÅ¡ i ispisuje ukupnu sumu za plaÄ‡anje. 
* Korisnik unosi iznos u `input` polje.
* Korisnik bira procenat (10%, 15% ili 20%) iz `select` menija.
* Klikom na dugme, JavaScript raÄuna bakÅ¡iÅ¡ i prikazuje rezultate na dve decimale.

### VeÅ¾ba 1: Radni prostor za BakÅ¡iÅ¡

<CodePlayground 
  mode="web"
  defaultHtml={`<div class="kalkulator">
  <h3>Kalkulator BakÅ¡iÅ¡a ğŸ’°</h3>
  <label>Iznos raÄuna (RSD):</label>
  <input type="number" id="racun" placeholder="npr. 2500">
  
  <label>Kvalitet usluge:</label>
  <select id="procenat">
    <option value="10">Ljubazna usluga (10%)</option>
    <option value="15" selected>OdliÄna usluga (15%)</option>
    <option value="20">Vrhunska usluga (20%)</option>
  </select>

  <button id="racunajBtn">IzraÄunaj</button>
  
  <div class="rezultat">
    <p>BakÅ¡iÅ¡: <span id="iznosBaksisa">0</span> RSD</p>
    <p><strong>Ukupno: <span id="ukupno">0</span> RSD</strong></p>
  </div>
</div>`}
  defaultCss={`.kalkulator { 
  font-family: sans-serif;
  max-width: 300px;
  padding: 20px;
  background: #ffffff;
  border: 2px solid #795548;
  border-radius: 12px;
}
input, select, button { 
  width: 100%; 
  margin-bottom: 15px; 
  padding: 10px; 
  border-radius: 6px;
  border: 1px solid #ddd;
  box-sizing: border-box;
}
button { background: #795548; color: white; cursor: pointer; }`}
  defaultJs={`// PokuÅ¡aj ovde da napiÅ¡eÅ¡ logiku pre nego Å¡to pogledaÅ¡ reÅ¡enje!`}
/>

<ZadatakZaVezbu 
  naslov="PrikaÅ¾i kompletno reÅ¡enje za BakÅ¡iÅ¡"
  kod={`const dugme = document.getElementById("racunajBtn");

dugme.addEventListener("click", () => {
    const racun = Number(document.getElementById("racun").value);
    const procenat = Number(document.getElementById("procenat").value);

    if (racun > 0) {
        const baksis = (racun * procenat) / 100;
        const suma = racun + baksis;

        document.getElementById("iznosBaksisa").textContent = baksis.toFixed(2);
        document.getElementById("ukupno").textContent = suma.toFixed(2);
    }
});`}
  analiza="Koristimo .toFixed(2) jer u radu sa novcem uvek Å¾elimo precizan prikaz decimala. Number() je obavezan jer HTML inputi uvek vraÄ‡aju string."
/>

---

## Zadatak 2: Interaktivni Dizajner Kartice ğŸ¨

**Postavka zadatka 2:**
Napravite panel koji omoguÄ‡ava promenu izgleda elementa u realnom vremenu (Real-time preview).
1. Promenite boju pozadine i teksta pomoÄ‡u `color` pickera.
2. Koristite `range` klizaÄ za promenu zaobljenosti ivica (`border-radius`).
3. Koristite `input` dogaÄ‘aj umesto `click` da bi se promene videle trenutno dok korisnik pomera kontrole.

### VeÅ¾ba 2: Radni prostor za Dizajn

<CodePlayground 
  mode="web"
  defaultHtml={`<div class="dizajn-panel">
  <h3>Dizajner Kartice ğŸ¨</h3>
  <label>Boja pozadine:</label>
  <input type="color" id="bgBoja" value="#ffffff">
  
  <label>Boja teksta:</label>
  <input type="color" id="textBoja" value="#333333">

  <label>Zaobljenost:</label>
  <input type="range" id="radius" min="0" max="50" value="10">

  <div id="testKartica" class="preview">
    <h4>Pregled</h4>
    <p>Promeni opcije iznad!</p>
  </div>
</div>`}
  defaultCss={`.dizajn-panel { font-family: sans-serif; padding: 15px; background: #f9f9f9; }
.preview { 
  margin-top: 20px; padding: 30px; 
  background: white; border: 1px solid #ccc; 
  text-align: center;
}`}
  defaultJs={`// PoveÅ¾i inpute sa stilovima kartice ovde`}
/>

<ZadatakZaVezbu 
  naslov="PrikaÅ¾i kompletno reÅ¡enje za Dizajner"
  kod={`const bg = document.getElementById("bgBoja");
const txt = document.getElementById("textBoja");
const rad = document.getElementById("radius");
const kartica = document.getElementById("testKartica");

// Koristimo 'input' dogaÄ‘aj za trenutni odziv
bg.addEventListener("input", () => {
    kartica.style.backgroundColor = bg.value;
});

txt.addEventListener("input", () => {
    kartica.style.color = txt.value;
});

rad.addEventListener("input", () => {
    // Ne zaboravite da dodate 'px' na kraju vrednosti!
    kartica.style.borderRadius = rad.value + "px";
});`}
  analiza="Direktna manipulacija stilom preko .style objekta je najbrÅ¾i naÄin za dinamiÄke promene dizajna."
/>

---

## Zadatak 3: Digitalni Termometar ğŸŒ¡ï¸

**Postavka zadatka 3:**
Napravite program koji klasifikuje temperaturu i vizuelno signalizira stanje pozadinom poruke.
* Ispod 10 stepeni: Pozadina plava, tekst "Hladno".
* Od 11 do 25 stepeni: Pozadina zelena, tekst "Idealno".
* Preko 25 stepeni: Pozadina crvena, tekst "Vrelo".

### VeÅ¾ba 3: Radni prostor za Termometar

<CodePlayground 
  mode="web"
  defaultHtml={`<div class="termometar">
  <h3>Termometar ğŸŒ¡ï¸</h3>
  <input type="number" id="tempInput" placeholder="Â°C">
  <button id="proveriBtn">Proveri</button>
  
  <div id="statusBox" class="prikaz">
    Status...
  </div>
</div>`}
  defaultCss={`.termometar { font-family: sans-serif; text-align: center; }
.prikaz { margin-top: 20px; padding: 20px; border-radius: 8px; font-weight: bold; background: #eee; }
button { padding: 10px; background: #333; color: white; border: none; cursor: pointer; }`}
  defaultJs={`// NapiÅ¡i if/else logiku ovde`}
/>

<ZadatakZaVezbu 
  naslov="PrikaÅ¾i kompletno reÅ¡enje za Termometar"
  kod={`const btn = document.getElementById("proveriBtn");
const box = document.getElementById("statusBox");

btn.addEventListener("click", () => {
    const t = Number(document.getElementById("tempInput").value);
    
    if (t <= 10) {
        box.textContent = "â„ï¸ Jako je hladno!";
        box.style.background = "#2196F3"; 
        box.style.color = "white";
    } else if (t > 10 && t <= 25) {
        box.textContent = "ğŸŒ¤ï¸ Temperatura je idealna.";
        box.style.background = "#4CAF50";
        box.style.color = "white";
    } else {
        box.textContent = "ğŸ”¥ Pazi, vrelo je!";
        box.style.background = "#F44336";
        box.style.color = "white";
    }
});`}
  analiza="Ovdje kombinujemo logiku uslova sa direktnom manipulacijom DOM elemenata."
/>